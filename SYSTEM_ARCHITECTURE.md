# ğŸ“‹ à¸£à¸°à¸šà¸šà¹€à¸à¸¡ Monster Pop Arena - à¸ªà¸–à¸²à¸›à¸±à¸•à¸¢à¸à¸£à¸£à¸¡à¹à¸¥à¸°à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™

## ğŸ“ à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹„à¸Ÿà¸¥à¹Œà¹à¸¥à¸°à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ

### ğŸ® à¹„à¸Ÿà¸¥à¹Œà¸«à¸¥à¸±à¸ (Core Files)

| à¹„à¸Ÿà¸¥à¹Œ | à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ | à¸ªà¹ˆà¸§à¸™à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰à¸‡à¸²à¸™ |
|------|---------|---------------|
| **Main.java** | à¸ˆà¸¸à¸”à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¸‚à¸­à¸‡à¹‚à¸›à¸£à¹à¸à¸£à¸¡ | Entry Point |
| **GameConfig.java** | à¹€à¸à¹‡à¸šà¸„à¹ˆà¸²à¸„à¸‡à¸—à¸µà¹ˆà¹à¸¥à¸°à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸•à¹ˆà¸²à¸‡à¹† à¸‚à¸­à¸‡à¹€à¸à¸¡ | Configuration |

### ğŸ–¥ï¸ à¸ªà¹ˆà¸§à¸™à¸•à¸´à¸”à¸•à¹ˆà¸­à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰ (UI Components)

| à¹„à¸Ÿà¸¥à¹Œ | à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ | à¸ªà¹ˆà¸§à¸™à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰à¸‡à¸²à¸™ |
|------|---------|---------------|
| **MainMenu.java** | à¸«à¸™à¹‰à¸²à¹€à¸¡à¸™à¸¹à¸«à¸¥à¸±à¸ à¹à¸ªà¸”à¸‡à¸›à¸¸à¹ˆà¸¡à¹€à¸£à¸´à¹ˆà¸¡à¹€à¸à¸¡/à¸­à¸­à¸ | Main Menu |
| **LobbyScreen.java** | à¸«à¸™à¹‰à¸²à¸£à¸­à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™ à¹à¸ªà¸”à¸‡à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™à¸—à¸µà¹ˆà¹€à¸‚à¹‰à¸²à¸£à¹ˆà¸§à¸¡ | Lobby Screen |
| **GamePanel.java** | à¸«à¸™à¹‰à¸²à¸ˆà¸­à¹€à¸à¸¡à¸«à¸¥à¸±à¸ à¹à¸ªà¸”à¸‡à¸à¸²à¸£à¹€à¸¥à¹ˆà¸™à¹€à¸à¸¡ | Game Screen |
| **GameOverScreen.java** | à¸«à¸™à¹‰à¸²à¸ˆà¸­à¸ªà¸£à¸¸à¸›à¸„à¸°à¹à¸™à¸™à¹€à¸¡à¸·à¹ˆà¸­à¹€à¸à¸¡à¸ˆà¸š | Game Over Screen |
| **MenuElement.java** | à¸„à¸¥à¸²à¸ªà¸ªà¸³à¸«à¸£à¸±à¸šà¸ªà¸£à¹‰à¸²à¸‡à¸­à¸‡à¸„à¹Œà¸›à¸£à¸°à¸à¸­à¸š UI (à¸›à¸¸à¹ˆà¸¡, à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡, à¸£à¸¹à¸›à¸ à¸²à¸) | UI Helper |
| **PopupWindow.java** | à¸«à¸™à¹‰à¸²à¸•à¹ˆà¸²à¸‡ Popup à¸ªà¸³à¸«à¸£à¸±à¸šà¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ | UI Component |
| **PopupWindowConfig.java** | à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸«à¸™à¹‰à¸²à¸•à¹ˆà¸²à¸‡ Popup | UI Configuration |
| **PopupWindowEditor.java** | à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸·à¸­à¹à¸à¹‰à¹„à¸‚ Popup (à¸ªà¸³à¸«à¸£à¸±à¸š Dev) | Development Tool |

### ğŸŒ à¸ªà¹ˆà¸§à¸™à¹€à¸„à¸£à¸·à¸­à¸‚à¹ˆà¸²à¸¢ (Network Components)

| à¹„à¸Ÿà¸¥à¹Œ | à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ | à¸ªà¹ˆà¸§à¸™à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰à¸‡à¸²à¸™ |
|------|---------|---------------|
| **GameClient.java** | à¸ˆà¸±à¸”à¸à¸²à¸£à¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¸à¸±à¹ˆà¸‡à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™ | Client-Side Network |
| **GameServer.java** | à¸ˆà¸±à¸”à¸à¸²à¸£à¹€à¸‹à¸´à¸£à¹Œà¸Ÿà¹€à¸§à¸­à¸£à¹Œà¹à¸¥à¸° Logic à¹€à¸à¸¡ | Server-Side Network |
| **GameServerGUI.java** | à¸«à¸™à¹‰à¸²à¸•à¹ˆà¸²à¸‡ GUI à¸ªà¸³à¸«à¸£à¸±à¸šà¹€à¸‹à¸´à¸£à¹Œà¸Ÿà¹€à¸§à¸­à¸£à¹Œ | Server UI |

### ğŸ² à¸ªà¹ˆà¸§à¸™à¸§à¸±à¸•à¸–à¸¸à¹ƒà¸™à¹€à¸à¸¡ (Game Objects)

| à¹„à¸Ÿà¸¥à¹Œ | à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ | à¸ªà¹ˆà¸§à¸™à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰à¸‡à¸²à¸™ |
|------|---------|---------------|
| **Player.java** | à¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™ (à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡, à¸„à¸°à¹à¸™à¸™, à¸ªà¸µ) | Game Entity |
| **HeadObject.java** | à¸§à¸±à¸•à¸–à¸¸à¸«à¸±à¸§à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸„à¸¥à¸´à¸ à¸¡à¸µà¸à¸²à¸£à¹€à¸„à¸¥à¸·à¹ˆà¸­à¸™à¹„à¸«à¸§ | Game Entity |
| **Explosion.java** | à¹€à¸­à¸Ÿà¹€à¸Ÿà¸à¸•à¹Œà¸£à¸°à¹€à¸šà¸´à¸”à¹€à¸¡à¸·à¹ˆà¸­à¸„à¸¥à¸´à¸à¸«à¸±à¸§ | Visual Effect |
| **ComboText.java** | à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸„à¸°à¹à¸™à¸™à¸¥à¸­à¸¢à¸‚à¸¶à¹‰à¸™ | Visual Effect |

### ğŸ¨ à¸ªà¹ˆà¸§à¸™à¸ªà¸™à¸±à¸šà¸ªà¸™à¸¸à¸™ (Utility Components)

| à¹„à¸Ÿà¸¥à¹Œ | à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ | à¸ªà¹ˆà¸§à¸™à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰à¸‡à¸²à¸™ |
|------|---------|---------------|
| **FontManager.java** | à¸ˆà¸±à¸”à¸à¸²à¸£à¸Ÿà¸­à¸™à¸•à¹Œà¸ à¸²à¸©à¸²à¹„à¸—à¸¢ | Font Management |
| **SoundManager.java** | à¸ˆà¸±à¸”à¸à¸²à¸£à¹€à¸ªà¸µà¸¢à¸‡à¹ƒà¸™à¹€à¸à¸¡ | Sound Management |
| **SpriteSheet.java** | à¸ˆà¸±à¸”à¸à¸²à¸£ Animation sprites | Animation System |

---

## ğŸ—ï¸ à¸ªà¸–à¸²à¸›à¸±à¸•à¸¢à¸à¸£à¸£à¸¡à¸£à¸°à¸šà¸š

### 1. à¹à¸šà¸šà¸ˆà¸³à¸¥à¸­à¸‡ Client-Server

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Game Server                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  GameServer.java                         â”‚      â”‚
â”‚  â”‚  - à¸£à¸±à¸š/à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™                  â”‚      â”‚
â”‚  â”‚  - à¸„à¸³à¸™à¸§à¸“ Physics                         â”‚      â”‚
â”‚  â”‚  - à¸ˆà¸±à¸”à¸à¸²à¸£à¸„à¸°à¹à¸™à¸™                           â”‚      â”‚
â”‚  â”‚  - Spawn/Respawn Heads                   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†• TCP/IP Socket
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client 1    â”‚  Client 2    â”‚  Client 3    â”‚Client 4 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚GameClientâ”‚ â”‚ â”‚GameClientâ”‚ â”‚ â”‚GameClientâ”‚ â”‚â”‚GameCliâ”‚â”‚
â”‚ â”‚  .java   â”‚ â”‚ â”‚  .java   â”‚ â”‚ â”‚  .java   â”‚ â”‚â”‚ent.javâ”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚      â†•       â”‚      â†•       â”‚      â†•       â”‚    â†•    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚GamePanel â”‚ â”‚ â”‚GamePanel â”‚ â”‚ â”‚GamePanel â”‚ â”‚â”‚GamePanâ”‚â”‚
â”‚ â”‚  .java   â”‚ â”‚ â”‚  .java   â”‚ â”‚ â”‚  .java   â”‚ â”‚â”‚el.javaâ”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. à¹‚à¸›à¸£à¹‚à¸•à¸„à¸­à¸¥à¸à¸²à¸£à¸ªà¸·à¹ˆà¸­à¸ªà¸²à¸£

#### ğŸ“¤ Server â†’ Client Messages
```
ID:P1,12345678              // à¸à¸³à¸«à¸™à¸” Player ID à¹à¸¥à¸°à¸ªà¸µ
NEW:P2,100,200,12345678,0   // à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™à¹ƒà¸«à¸¡à¹ˆà¹€à¸‚à¹‰à¸²à¸£à¹ˆà¸§à¸¡
UPDATE:P2,150,250,12345678,5 // à¸­à¸±à¸à¹€à¸”à¸•à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™
REMOVE:P2                   // à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™à¸­à¸­à¸
NEWHEAD:0,100,200,2.5,1.5,3 // à¸«à¸±à¸§à¹ƒà¸«à¸¡à¹ˆà¸›à¸£à¸²à¸à¸
HEADSYNC:0,100,200,2.5,1.5,3|1,200,300,1.0,2.0,1  // à¸‹à¸´à¸‡à¸„à¹Œà¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸«à¸±à¸§à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
SCORE:P1,15                 // à¸­à¸±à¸à¹€à¸”à¸•à¸„à¸°à¹à¸™à¸™
TIME:95                     // à¹€à¸§à¸¥à¸²à¸—à¸µà¹ˆà¹€à¸«à¸¥à¸·à¸­ (à¸§à¸´à¸™à¸²à¸—à¸µ)
GAMESTARTING                // à¹€à¸à¸¡à¸à¸³à¸¥à¸±à¸‡à¸ˆà¸°à¹€à¸£à¸´à¹ˆà¸¡
GAMEINPROGRESS              // à¹€à¸à¸¡à¸à¸³à¸¥à¸±à¸‡à¸”à¸³à¹€à¸™à¸´à¸™à¸­à¸¢à¸¹à¹ˆ
GAMEOVER                    // à¹€à¸à¸¡à¸ˆà¸š
NEWGAME                     // à¹€à¸£à¸´à¹ˆà¸¡à¹€à¸à¸¡à¹ƒà¸«à¸¡à¹ˆ
```

#### ğŸ“¥ Client â†’ Server Messages
```
POS:150,250                 // à¸ªà¹ˆà¸‡à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡ cursor
HIT:5                       // à¸„à¸¥à¸´à¸à¸«à¸±à¸§ ID 5
```

---

## ğŸ¨ 1. à¸à¸²à¸£à¸§à¸²à¸”à¸”à¹‰à¸§à¸¢ Paint à¹à¸¥à¸° PaintComponent

### à¸—à¸³à¸‡à¸²à¸™à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£?
Java Swing à¹ƒà¸Šà¹‰à¸£à¸°à¸šà¸š **Double Buffering** à¹€à¸à¸·à¹ˆà¸­à¸§à¸²à¸”à¸ à¸²à¸à¸—à¸µà¹ˆà¸¥à¸·à¹ˆà¸™à¹„à¸«à¸¥

### à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¹‚à¸„à¹‰à¸”: GamePanel.java

```java
public class GamePanel extends JPanel {
    private BufferedImage backgroundImage;
    
    public GamePanel(GameClient client) {
        setDoubleBuffered(true);  // à¹€à¸›à¸´à¸”à¹ƒà¸Šà¹‰ Double Buffering
        
        // Timer à¸ªà¸³à¸«à¸£à¸±à¸š repaint à¸—à¸¸à¸ 16ms (â‰ˆ60 FPS)
        Timer timer = new Timer(GameConfig.RENDER_UPDATE_INTERVAL, e -> repaint());
        timer.start();
    }
    
    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        Graphics2D g2d = (Graphics2D) g;
        
        // à¹€à¸›à¸´à¸” Anti-aliasing à¸ªà¸³à¸«à¸£à¸±à¸šà¸ à¸²à¸à¸—à¸µà¹ˆà¸¥à¸·à¹ˆà¸™à¹„à¸«à¸¥
        g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, 
                            RenderingHints.VALUE_ANTIALIAS_ON);
        
        // 1. à¸§à¸²à¸”à¸à¸·à¹‰à¸™à¸«à¸¥à¸±à¸‡
        if (backgroundImage != null) {
            g2d.drawImage(backgroundImage, 0, 0, getWidth(), getHeight(), null);
        }
        
        // 2. à¸§à¸²à¸”à¸§à¸±à¸•à¸–à¸¸à¹ƒà¸™à¹€à¸à¸¡ (Heads)
        for (HeadObject head : heads.values()) {
            head.render(g2d);
        }
        
        // 3. à¸§à¸²à¸” Effects (Explosions)
        for (Explosion explosion : explosions) {
            explosion.render(g2d);
        }
        
        // 4. à¸§à¸²à¸” UI
        drawScoreboard(g2d);
        drawTimer(g2d);
    }
}
```

### à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡: à¸à¸²à¸£à¸§à¸²à¸”à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹à¸¥à¸°à¸£à¸¹à¸›à¸ à¸²à¸

```java
private void drawTimer(Graphics2D g2d) {
    int minutes = (int) (remainingTime / 60);
    int seconds = (int) (remainingTime % 60);
    String timeText = String.format("%02d:%02d", minutes, seconds);
    
    // à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸Ÿà¸­à¸™à¸•à¹Œ
    g2d.setFont(FontManager.getFont(Font.BOLD, 48));
    FontMetrics fm = g2d.getFontMetrics();
    int textWidth = fm.stringWidth(timeText);
    
    // à¸§à¸²à¸”à¸à¸·à¹‰à¸™à¸«à¸¥à¸±à¸‡à¹‚à¸›à¸£à¹ˆà¸‡à¹ƒà¸ª
    g2d.setColor(new Color(0, 0, 0, 100));
    g2d.fillRoundRect(800 - textWidth/2 - 20, 20, textWidth + 40, 60, 15, 15);
    
    // à¸§à¸²à¸”à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡
    g2d.setColor(Color.WHITE);
    g2d.drawString(timeText, 800 - textWidth/2, 65);
}
```

### MenuElement.java - à¸£à¸°à¸šà¸šà¸§à¸²à¸” UI

```java
public class MenuElement {
    public enum ElementType { TEXT, IMAGE }
    
    private ElementType type;
    private String content;
    private BufferedImage image;
    private double x, y, width, height;
    
    public void render(Graphics2D g2d) {
        if (type == ElementType.IMAGE && image != null) {
            // à¸§à¸²à¸”à¸£à¸¹à¸›à¸ à¸²à¸à¸ˆà¸²à¸à¸ˆà¸¸à¸”à¸à¸¶à¹ˆà¸‡à¸à¸¥à¸²à¸‡
            int drawX = (int)(x - width / 2);
            int drawY = (int)(y - height / 2);
            g2d.drawImage(image, drawX, drawY, (int)width, (int)height, null);
        } 
        else if (type == ElementType.TEXT) {
            // à¸§à¸²à¸”à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸ˆà¸²à¸à¸ˆà¸¸à¸”à¸à¸¶à¹ˆà¸‡à¸à¸¥à¸²à¸‡
            g2d.setFont(FontManager.getThaiFont(fontSize));
            FontMetrics fm = g2d.getFontMetrics();
            int textWidth = fm.stringWidth(content);
            g2d.setColor(textColor);
            g2d.drawString(content, (int)(x - textWidth/2), (int)(y + fontSize/3));
        }
    }
}
```

---

## âš™ï¸ 2. à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™à¹à¸šà¸š Multi-Tasking (Thread)

### Thread à¸«à¸¥à¸±à¸à¹ƒà¸™à¸£à¸°à¸šà¸š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Main Thread (EDT)                   â”‚
â”‚  - à¸ˆà¸±à¸”à¸à¸²à¸£ UI events                             â”‚
â”‚  - Mouse clicks, movements                      â”‚
â”‚  - Repaint UI                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Network Thread (GameClient)              â”‚
â”‚  - à¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸ Server (blocking I/O)           â”‚
â”‚  - à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥ messages                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Timer Thread (Swing Timer)             â”‚
â”‚  - repaint() à¸—à¸¸à¸ 16ms                           â”‚
â”‚  - à¸­à¸±à¸à¹€à¸”à¸• animation frames                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¹‚à¸„à¹‰à¸” 1: Network Thread (GameClient.java)

```java
public class GameClient extends JFrame {
    private Socket socket;
    private PrintWriter out;
    private BufferedReader in;
    
    private void connectToServer() {
        try {
            socket = new Socket(serverIP, GameConfig.SERVER_PORT);
            out = new PrintWriter(socket.getOutputStream(), true);
            in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
            
            // à¸ªà¸£à¹‰à¸²à¸‡ Thread à¹à¸¢à¸à¸ªà¸³à¸«à¸£à¸±à¸šà¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥
            new Thread(this::receiveMessages).start();
            
        } catch (IOException e) {
            // à¸ˆà¸±à¸”à¸à¸²à¸£ error
        }
    }
    
    // Thread à¹à¸¢à¸: à¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸ Server
    private void receiveMessages() {
        try {
            String message;
            while ((message = in.readLine()) != null) {
                processMessage(message);  // à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
            }
        } catch (IOException e) {
            System.err.println("Connection lost");
        }
    }
    
    // à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸¥à¸°à¸­à¸±à¸à¹€à¸”à¸• UI à¹ƒà¸™ EDT
    private void processMessage(String message) {
        if (message.startsWith("NEW:")) {
            Player player = Player.fromMessage(message.substring(4));
            
            // à¸­à¸±à¸à¹€à¸”à¸• UI à¸•à¹‰à¸­à¸‡à¸—à¸³à¹ƒà¸™ EDT
            SwingUtilities.invokeLater(() -> {
                if (gamePanel != null) {
                    gamePanel.addPlayer(player);
                }
            });
        }
    }
}
```

### à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¹‚à¸„à¹‰à¸” 2: Game Start Delay Thread

```java
private void startGame() {
    if (gameStarted) return;
    gameStarted = true;
    
    // à¸ªà¸£à¹‰à¸²à¸‡ Thread à¹à¸¢à¸à¸ªà¸³à¸«à¸£à¸±à¸š delay
    new Thread(() -> {
        try {
            Thread.sleep(GameConfig.GAME_START_DELAY);  // à¸£à¸­ 3 à¸§à¸´à¸™à¸²à¸—à¸µ
        } catch (InterruptedException e) {
        }
        
        // à¸à¸¥à¸±à¸šà¸¡à¸²à¸ªà¸£à¹‰à¸²à¸‡ UI à¹ƒà¸™ EDT
        SwingUtilities.invokeLater(() -> {
            if (lobbyScreen != null) {
                lobbyScreen.dispose();
            }
            
            setTitle("Monster Pop Arena");
            gamePanel = new GamePanel(this);
            add(gamePanel);
            pack();
            setVisible(true);
        });
    }).start();
}
```

### à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¹‚à¸„à¹‰à¸” 3: Server Physics Thread (GameServer.java)

```java
public class GameServer {
    private Timer physicsTimer;
    
    private void startPhysicsLoop() {
        physicsTimer = new Timer();
        
        // à¸ªà¸£à¹‰à¸²à¸‡ Thread à¸—à¸µà¹ˆà¸—à¸³à¸‡à¸²à¸™à¸—à¸¸à¸ 16ms
        physicsTimer.scheduleAtFixedRate(new TimerTask() {
            @Override
            public void run() {
                updatePhysics();  // à¸­à¸±à¸à¹€à¸”à¸•à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸§à¸±à¸•à¸–à¸¸
                broadcastToAll("HEADSYNC:" + serializeHeads());  // à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
            }
        }, 0, GameConfig.PHYSICS_UPDATE_INTERVAL);
    }
    
    private void updatePhysics() {
        // à¸­à¸±à¸à¹€à¸”à¸•à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸«à¸±à¸§à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
        for (HeadObject head : heads.values()) {
            head.update();  // à¹€à¸„à¸¥à¸·à¹ˆà¸­à¸™à¸—à¸µà¹ˆ + à¸Šà¸™à¸‚à¸­à¸š
        }
    }
}
```

### HeadObject.java - à¸à¸²à¸£à¸­à¸±à¸à¹€à¸”à¸•à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡

```java
public class HeadObject {
    private double x, y;      // à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡
    private double vx, vy;    // à¸„à¸§à¸²à¸¡à¹€à¸£à¹‡à¸§
    
    public void update() {
        // à¹€à¸„à¸¥à¸·à¹ˆà¸­à¸™à¸—à¸µà¹ˆ
        x += vx;
        y += vy;
        
        // à¸Šà¸™à¸‚à¸­à¸šà¸‹à¹‰à¸²à¸¢-à¸‚à¸§à¸²
        if (x < 0 || x > GameConfig.WINDOW_WIDTH - GameConfig.HEAD_DEFAULT_SIZE) {
            vx = -vx;
            x = Math.max(0, Math.min(x, GameConfig.WINDOW_WIDTH - GameConfig.HEAD_DEFAULT_SIZE));
        }
        
        // à¸Šà¸™à¸‚à¸­à¸šà¸šà¸™-à¸¥à¹ˆà¸²à¸‡
        if (y < 0 || y > GameConfig.WINDOW_HEIGHT - GameConfig.HEAD_DEFAULT_SIZE) {
            vy = -vy;
            y = Math.max(0, Math.min(y, GameConfig.WINDOW_HEIGHT - GameConfig.HEAD_DEFAULT_SIZE));
        }
        
        // à¸­à¸±à¸à¹€à¸”à¸• animation frame
        animationTimer += GameConfig.PHYSICS_UPDATE_INTERVAL;
        if (animationTimer >= frameDelay) {
            currentFrame = (currentFrame + 1) % totalFrames;
            animationTimer = 0;
        }
    }
}
```

### à¸à¸²à¸£à¹ƒà¸Šà¹‰ Thread-Safe Collections

```java
// à¹ƒà¸™ GamePanel.java
private Map<String, Player> players = new ConcurrentHashMap<>();
private Map<Integer, HeadObject> heads = new ConcurrentHashMap<>();
private List<Explosion> explosions = new CopyOnWriteArrayList<>();

// ConcurrentHashMap: à¸«à¸¥à¸²à¸¢ Thread à¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¸à¸£à¹‰à¸­à¸¡à¸à¸±à¸™à¹„à¸”à¹‰à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢
// CopyOnWriteArrayList: à¹€à¸«à¸¡à¸²à¸°à¸ªà¸³à¸«à¸£à¸±à¸š read à¸¡à¸²à¸ write à¸™à¹‰à¸­à¸¢
```

---

## ğŸŒ 3. à¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¸œà¹ˆà¸²à¸™à¹€à¸„à¸£à¸·à¸­à¸‚à¹ˆà¸²à¸¢ (Client-Server)

### à¸ªà¸–à¸²à¸›à¸±à¸•à¸¢à¸à¸£à¸£à¸¡ TCP/IP

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   GameServer                        â”‚
â”‚  ServerSocket (Port 25565)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  while(true) {                           â”‚     â”‚
â”‚  â”‚    Socket client = serverSocket.accept() â”‚     â”‚
â”‚  â”‚    new Thread(clientHandler).start()     â”‚     â”‚
â”‚  â”‚  }                                       â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ClientHandlerâ”‚ â”‚ClientHandlerâ”‚ â”‚ClientHandlerâ”‚ â”‚
â”‚  â”‚  Thread 1   â”‚ â”‚  Thread 2   â”‚ â”‚  Thread 3   â”‚ â”‚
â”‚  â”‚  (Player 1) â”‚ â”‚  (Player 2) â”‚ â”‚  (Player 3) â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†•                â†•                â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client 1   â”‚  â”‚  Client 2   â”‚  â”‚  Client 3   â”‚
â”‚  Socket     â”‚  â”‚  Socket     â”‚  â”‚  Socket     â”‚
â”‚  (P1)       â”‚  â”‚  (P2)       â”‚  â”‚  (P3)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡: Server Setup (GameServer.java)

```java
public class GameServer {
    private Set<ClientHandler> clients = ConcurrentHashMap.newKeySet();
    private Map<String, Player> players = new ConcurrentHashMap<>();
    
    public void start() {
        try (ServerSocket serverSocket = new ServerSocket(GameConfig.SERVER_PORT)) {
            log("à¹€à¸‹à¸´à¸£à¹Œà¸Ÿà¹€à¸§à¸­à¸£à¹Œà¹€à¸£à¸´à¹ˆà¸¡à¸—à¸³à¸‡à¸²à¸™à¸—à¸µà¹ˆ Port: " + GameConfig.SERVER_PORT);
            
            // Loop à¸£à¸­à¸£à¸±à¸šà¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­
            while (true) {
                Socket socket = serverSocket.accept();
                log("à¸¡à¸µà¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¸ˆà¸²à¸: " + socket.getInetAddress());
                
                // à¸ªà¸£à¹‰à¸²à¸‡ Handler à¹à¸¢à¸à¸ªà¸³à¸«à¸£à¸±à¸šà¹à¸•à¹ˆà¸¥à¸° Client
                ClientHandler handler = new ClientHandler(socket);
                clients.add(handler);
                new Thread(handler).start();
            }
        } catch (IOException e) {
            log("à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”: " + e.getMessage());
        }
    }
    
    // à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸–à¸¶à¸‡à¸—à¸¸à¸à¸„à¸™
    private void broadcastToAll(String message) {
        for (ClientHandler client : clients) {
            client.sendMessage(message);
        }
    }
    
    // à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸–à¸¶à¸‡à¸—à¸¸à¸à¸„à¸™à¸¢à¸à¹€à¸§à¹‰à¸™à¸œà¸¹à¹‰à¸ªà¹ˆà¸‡
    private void broadcast(String message, ClientHandler sender) {
        for (ClientHandler client : clients) {
            if (client != sender) {
                client.sendMessage(message);
            }
        }
    }
}
```

### à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡: Client Handler (GameServer.java)

```java
class ClientHandler implements Runnable {
    private Socket socket;
    private PrintWriter out;
    private BufferedReader in;
    private String playerId;
    
    @Override
    public void run() {
        try {
            // à¹€à¸›à¸´à¸” Stream à¸ªà¸³à¸«à¸£à¸±à¸šà¸£à¸±à¸š/à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
            out = new PrintWriter(socket.getOutputStream(), true);
            in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
            
            // à¸ªà¸£à¹‰à¸²à¸‡à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™à¹ƒà¸«à¸¡à¹ˆ
            playerId = "P" + nextPlayerNumber++;
            Player newPlayer = new Player(playerId, randomColor);
            players.put(playerId, newPlayer);
            
            // à¸ªà¹ˆà¸‡ ID à¹ƒà¸«à¹‰ Client
            out.println("ID:" + playerId + "," + playerColor.getRGB());
            
            // à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™à¹€à¸”à¸´à¸¡à¹ƒà¸«à¹‰ Client à¹ƒà¸«à¸¡à¹ˆ
            for (Player p : players.values()) {
                if (!p.getId().equals(playerId)) {
                    out.println("NEW:" + p.toMessage());
                }
            }
            
            // à¹à¸ˆà¹‰à¸‡à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™à¸—à¸¸à¸à¸„à¸™à¸§à¹ˆà¸²à¸¡à¸µà¸„à¸™à¹ƒà¸«à¸¡à¹ˆà¹€à¸‚à¹‰à¸²à¸¡à¸²
            broadcast("NEW:" + newPlayer.toMessage(), this);
            
            // Loop à¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸ Client
            String message;
            while ((message = in.readLine()) != null) {
                if (message.startsWith("POS:")) {
                    // à¸­à¸±à¸à¹€à¸”à¸•à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡
                    String[] parts = message.substring(4).split(",");
                    int x = Integer.parseInt(parts[0]);
                    int y = Integer.parseInt(parts[1]);
                    
                    Player player = players.get(playerId);
                    player.setPosition(x, y);
                    
                    // à¸ªà¹ˆà¸‡à¸•à¹ˆà¸­à¹„à¸›à¸¢à¸±à¸‡à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™à¸„à¸™à¸­à¸·à¹ˆà¸™
                    broadcast("UPDATE:" + player.toMessage(), this);
                    
                } else if (message.startsWith("HIT:")) {
                    // à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥à¸à¸²à¸£à¸„à¸¥à¸´à¸à¸«à¸±à¸§
                    int headId = Integer.parseInt(message.substring(4));
                    HeadObject head = heads.get(headId);
                    
                    if (head != null) {
                        Player player = players.get(playerId);
                        
                        if (head.isSkull()) {
                            player.addScore(-GameConfig.SKULL_PENALTY);
                        } else {
                            player.addScore(GameConfig.SCORE_PER_HIT);
                        }
                        
                        respawnHead(headId);
                        broadcastToAll("SCORE:" + playerId + "," + player.getScore());
                    }
                }
            }
        } catch (IOException e) {
            log("à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™à¸•à¸±à¸”à¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­: " + playerId);
        } finally {
            cleanup();
        }
    }
    
    private void cleanup() {
        clients.remove(this);
        if (playerId != null) {
            players.remove(playerId);
            broadcast("REMOVE:" + playerId, this);
        }
        try {
            socket.close();
        } catch (IOException e) {
        }
    }
}
```

### à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡: Client Connection (GameClient.java)

```java
public class GameClient extends JFrame {
    private Socket socket;
    private PrintWriter out;
    private BufferedReader in;
    
    private void connectToServer() {
        try {
            // à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¹„à¸›à¸¢à¸±à¸‡ Server
            socket = new Socket(serverIP, GameConfig.SERVER_PORT);
            
            // à¹€à¸›à¸´à¸” Stream à¸ªà¸³à¸«à¸£à¸±à¸šà¸£à¸±à¸š/à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
            out = new PrintWriter(socket.getOutputStream(), true);
            in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
            
            // à¸ªà¸£à¹‰à¸²à¸‡ Thread à¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥
            new Thread(this::receiveMessages).start();
            
        } catch (IOException e) {
            // à¹à¸ªà¸”à¸‡ Dialog à¹ƒà¸«à¹‰à¹ƒà¸ªà¹ˆ IP à¹ƒà¸«à¸¡à¹ˆ
            showIPDialog();
        }
    }
    
    // Thread à¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸ Server
    private void receiveMessages() {
        try {
            String message;
            while ((message = in.readLine()) != null) {
                processMessage(message);
            }
        } catch (IOException e) {
            System.err.println("Connection lost");
        }
    }
    
    // à¸ªà¹ˆà¸‡à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡ cursor à¹„à¸›à¸¢à¸±à¸‡ Server
    public void sendPosition(int x, int y) {
        if (out != null) {
            out.println("POS:" + x + "," + y);
        }
    }
    
    // à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¸²à¸£à¸„à¸¥à¸´à¸à¸«à¸±à¸§
    public void sendHeadHit(int headId) {
        if (out != null) {
            out.println("HIT:" + headId);
        }
    }
}
```

### à¸à¸²à¸£à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸šà¸šà¸¡à¸µà¸›à¸£à¸°à¸ªà¸´à¸—à¸˜à¸´à¸ à¸²à¸

```java
// à¹ƒà¸™ GamePanel.java - à¸ˆà¸³à¸à¸±à¸”à¸à¸²à¸£à¸ªà¹ˆà¸‡à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡
addMouseMotionListener(new MouseMotionAdapter() {
    private long lastSendTime = 0;
    
    @Override
    public void mouseMoved(MouseEvent e) {
        if (myPlayerId != null) {
            Player me = players.get(myPlayerId);
            if (me != null) {
                me.setPosition(e.getX(), e.getY());
                
                // à¸ªà¹ˆà¸‡à¹„à¸›à¸¢à¸±à¸‡ Server à¹€à¸‰à¸à¸²à¸°à¸—à¸¸à¸ 50ms
                long currentTime = System.currentTimeMillis();
                if (currentTime - lastSendTime >= GameConfig.POSITION_SEND_INTERVAL) {
                    client.sendPosition(e.getX(), e.getY());
                    lastSendTime = currentTime;
                }
            }
        }
    }
});
```

---

## ğŸ”„ Flow à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™à¸—à¸±à¹‰à¸‡à¸£à¸°à¸šà¸š

### 1. à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¹€à¸à¸¡

```
[Client Start] â†’ MainMenu â†’ à¸à¸”à¸›à¸¸à¹ˆà¸¡ "à¹€à¸£à¸´à¹ˆà¸¡à¹€à¸à¸¡"
                    â†“
              [GameClient]
                    â†“
         connectToServer(IP, Port)
                    â†“
         [Server accepts connection]
                    â†“
         Server: à¸ªà¸£à¹‰à¸²à¸‡ ClientHandler Thread
                    â†“
         Server: à¸ªà¹ˆà¸‡ "ID:P1,<color>"
                    â†“
         Client: à¸£à¸±à¸š ID â†’ à¹à¸ªà¸”à¸‡ LobbyScreen
                    â†“
         à¸£à¸­à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™à¸„à¸£à¸š (MIN_PLAYERS)
                    â†“
         Server: à¸ªà¹ˆà¸‡ "GAMESTARTING"
                    â†“
         Client: à¸£à¸­ 3 à¸§à¸´à¸™à¸²à¸—à¸µ â†’ à¹à¸ªà¸”à¸‡ GamePanel
```

### 2. à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¹€à¸à¸¡

```
[à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™à¹€à¸„à¸¥à¸·à¹ˆà¸­à¸™à¹€à¸¡à¸²à¸ªà¹Œ]
        â†“
Client: mouseMoved() â†’ sendPosition(x,y)
        â†“
Server: à¸£à¸±à¸š "POS:x,y" â†’ à¸­à¸±à¸à¹€à¸”à¸• Player
        â†“
Server: broadcast "UPDATE:P1,x,y,color,score"
        â†“
Clients à¸­à¸·à¹ˆà¸™: à¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ â†’ à¸­à¸±à¸à¹€à¸”à¸•à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡ cursor


[à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™à¸„à¸¥à¸´à¸à¸«à¸±à¸§]
        â†“
Client: checkHeadClick() â†’ sendHeadHit(headId)
        â†“
Server: à¸£à¸±à¸š "HIT:headId"
        â†“
Server: à¸„à¸³à¸™à¸§à¸“à¸„à¸°à¹à¸™à¸™ + respawnHead()
        â†“
Server: broadcast "SCORE:P1,<newScore>"
        â†“
All Clients: à¸­à¸±à¸à¹€à¸”à¸•à¸„à¸°à¹à¸™à¸™à¹ƒà¸™ Scoreboard


[Server Physics Loop - à¸—à¸¸à¸ 16ms]
        â†“
Server: updatePhysics() â†’ à¹€à¸„à¸¥à¸·à¹ˆà¸­à¸™à¸«à¸±à¸§à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”
        â†“
Server: broadcast "HEADSYNC:<all heads data>"
        â†“
Clients: à¸­à¸±à¸à¹€à¸”à¸•à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸«à¸±à¸§ â†’ repaint()
```

### 3. à¸ˆà¸šà¹€à¸à¸¡

```
[à¹€à¸§à¸¥à¸²à¸«à¸¡à¸”: 120 à¸§à¸´à¸™à¸²à¸—à¸µ]
        â†“
Server: broadcast "GAMEOVER"
        â†“
Client: gamePanel.endGame()
        â†“
Client: à¹à¸ªà¸”à¸‡ GameOverScreen (Top 3)
        â†“
Client: disconnect à¸«à¸¥à¸±à¸‡ 3 à¸§à¸´à¸™à¸²à¸—à¸µ
        â†“
Server: à¸£à¸­ 5 à¸§à¸´à¸™à¸²à¸—à¸µ â†’ resetGame()
        â†“
Server: broadcast "NEWGAME"
```

---

## ğŸ“Š à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¸ªà¹ˆà¸‡à¸œà¹ˆà¸²à¸™ Network

### à¸à¸²à¸£ Serialize/Deserialize

```java
// Player.java
public String toMessage() {
    return id + "," + x + "," + y + "," + color.getRGB() + "," + score;
}

public static Player fromMessage(String message) {
    String[] parts = message.split(",");
    String id = parts[0];
    int x = Integer.parseInt(parts[1]);
    int y = Integer.parseInt(parts[2]);
    Color color = new Color(Integer.parseInt(parts[3]));
    int score = Integer.parseInt(parts[4]);
    
    Player p = new Player(id, color);
    p.setPosition(x, y);
    p.setScore(score);
    return p;
}
```

```java
// HeadObject.java
public String toMessage() {
    return id + "," + x + "," + y + "," + vx + "," + vy + "," + imagePath;
}

public static HeadObject fromMessage(String message) {
    String[] parts = message.split(",");
    int id = Integer.parseInt(parts[0]);
    double x = Double.parseDouble(parts[1]);
    double y = Double.parseDouble(parts[2]);
    double vx = Double.parseDouble(parts[3]);
    double vy = Double.parseDouble(parts[4]);
    String imagePath = parts[5];
    
    return new HeadObject(id, x, y, vx, vy, imagePath);
}
```

---

## âš¡ à¸à¸²à¸£ Optimize Performance

### 1. Render Optimization
- à¹ƒà¸Šà¹‰ `setDoubleBuffered(true)` à¹€à¸à¸·à¹ˆà¸­à¸¥à¸” flickering
- à¸ˆà¸³à¸à¸±à¸” repaint rate à¸—à¸µà¹ˆ 60 FPS (16ms)
- à¹ƒà¸Šà¹‰ `CopyOnWriteArrayList` à¸ªà¸³à¸«à¸£à¸±à¸š effects à¸—à¸µà¹ˆà¸¡à¸µà¸à¸²à¸£ iterate à¸šà¹ˆà¸­à¸¢

### 2. Network Optimization
- à¸ˆà¸³à¸à¸±à¸”à¸à¸²à¸£à¸ªà¹ˆà¸‡à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¹€à¸¡à¸²à¸ªà¹Œà¸—à¸µà¹ˆ 50ms
- à¹ƒà¸Šà¹‰ `ConcurrentHashMap` à¸ªà¸³à¸«à¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ multi-thread
- Batch update à¸«à¸¥à¸²à¸¢ heads à¹ƒà¸™à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹€à¸”à¸µà¸¢à¸§ (HEADSYNC)

### 3. Thread Safety
- à¹ƒà¸Šà¹‰ `SwingUtilities.invokeLater()` à¸ªà¸³à¸«à¸£à¸±à¸šà¸­à¸±à¸à¹€à¸”à¸• UI
- à¹ƒà¸Šà¹‰ Thread-safe collections
- à¹à¸¢à¸ Thread à¸ªà¸³à¸«à¸£à¸±à¸š blocking I/O

---

## ğŸ¯ à¸ªà¸£à¸¸à¸›

à¸£à¸°à¸šà¸šà¹€à¸à¸¡ Monster Pop Arena à¹ƒà¸Šà¹‰à¸ªà¸–à¸²à¸›à¸±à¸•à¸¢à¸à¸£à¸£à¸¡ Client-Server à¹à¸šà¸š Real-time à¹‚à¸”à¸¢:

1. **à¸à¸²à¸£à¸§à¸²à¸” (Rendering):** à¹ƒà¸Šà¹‰ `paintComponent()` + Double Buffering + Anti-aliasing
2. **Multi-Threading:** à¹à¸¢à¸ Thread à¸ªà¸³à¸«à¸£à¸±à¸š Network, Timer, à¹à¸¥à¸° UI (EDT)
3. **Networking:** à¹ƒà¸Šà¹‰ TCP Socket + Protocol à¹à¸šà¸š text-based + Thread à¸•à¹ˆà¸­ Client

à¸£à¸°à¸šà¸šà¸–à¸¹à¸à¸­à¸­à¸à¹à¸šà¸šà¹ƒà¸«à¹‰à¸£à¸­à¸‡à¸£à¸±à¸šà¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™ 4 à¸„à¸™à¸à¸£à¹‰à¸­à¸¡à¸à¸±à¸™ à¸¡à¸µà¸à¸²à¸£à¸‹à¸´à¸‡à¸„à¹Œà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸šà¸š Real-time à¹à¸¥à¸°à¸ˆà¸±à¸”à¸à¸²à¸£ Physics à¸à¸±à¹ˆà¸‡ Server à¹€à¸à¸·à¹ˆà¸­à¸„à¸§à¸²à¸¡à¹€à¸›à¹‡à¸™à¸˜à¸£à¸£à¸¡

---

ğŸ“ à¹€à¸­à¸à¸ªà¸²à¸£à¸™à¸µà¹‰à¸ªà¸£à¹‰à¸²à¸‡à¸‚à¸¶à¹‰à¸™à¹€à¸à¸·à¹ˆà¸­à¸­à¸˜à¸´à¸šà¸²à¸¢à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™à¸‚à¸­à¸‡à¸£à¸°à¸šà¸šà¹€à¸à¸¡ Monster Pop Arena

